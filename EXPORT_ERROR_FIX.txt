â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  EXPORT ERROR FIX - "error: bad order function: COMMAND"                  â•‘
â•‘  MacroManager v5.13 - Script Generation Correction                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”´ THE PROBLEM
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ERROR MESSAGE:
  "error: bad order function: COMMAND"

WHEN IT OCCURS:
  During EXPORT BLOCKS operation
  When AutoCAD runs the generated .SCR script file

ROOT CAUSE:
  The script file had an extra blank line at the end of each WBLOCK command
  AutoCAD interpreted this blank line as a function call to COMMAND
  This caused: "error: bad order function: COMMAND"


ğŸ” TECHNICAL ANALYSIS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

WHAT WAS WRONG (Lines 854-858):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

(write-line (strcat "-WBLOCK") script_handle)
(write-line (strcat "\"" dwg_path "\"") script_handle)
(write-line (strcat "=" block_name) script_handle)
(write-line "" script_handle)  ;; â† EXTRA BLANK LINE (WRONG!)

This generated script file looking like:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

-WBLOCK
"C:\path\block_001.dwg"
=block_001

-WBLOCK
"C:\path\block_002.dwg"
=block_002

^
The blank line here tells AutoCAD the WBLOCK command is done
But then AutoCAD finds nothing on the next line
So it treats that nothing as "COMMAND" function call
Result: "error: bad order function: COMMAND"


WHAT'S CORRECT (After Fix):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

(write-line (strcat "-WBLOCK") script_handle)
(write-line (strcat "\"" dwg_path "\"") script_handle)
(write-line (strcat "=" block_name) script_handle)
;; NO extra blank line here

This generates script file looking like:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

-WBLOCK
"C:\path\block_001.dwg"
=block_001
-WBLOCK
"C:\path\block_002.dwg"
=block_002

^
Each command runs cleanly without interpreting blank lines
AutoCAD executes WBLOCK commands correctly
No "bad order function" error


âœ… THE FIX (Applied November 10, 2025)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FILE: MacroManager_v5.13.lsp
LOCATION: Lines 854-858
CHANGE: Removed the extra blank line write command

BEFORE:
  (write-line (strcat "-WBLOCK") script_handle)
  (write-line (strcat "\"" dwg_path "\"") script_handle)
  (write-line (strcat "=" block_name) script_handle)
  (write-line "" script_handle)  ;; â† DELETED

AFTER:
  (write-line (strcat "-WBLOCK") script_handle)
  (write-line (strcat "\"" dwg_path "\"") script_handle)
  (write-line (strcat "=" block_name) script_handle)
  ;; NO extra blank line here


ğŸ§ª TESTING THE FIX
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 1: Reload the Fixed File
  Command: (load "MacroManager_v5.13.lsp")
  Expected: Startup message shown, no errors

STEP 2: Open MacroManager Dialog
  Command: MACROMANAGER
  Expected: Dialog opens normally

STEP 3: Run Export Again
  â”œâ”€ Select block library folder
  â”œâ”€ Select blocks
  â”œâ”€ Choose export method: Script
  â”œâ”€ Click "EXPORT BLOCKS"
  â””â”€ Expected: âœ“ Export completes WITHOUT "error: bad order function"

STEP 4: Check Generated Script File
  Location: [Block Library Folder]\export_blocks.scr
  Content: Should show -WBLOCK commands WITHOUT extra blank lines
  
  CORRECT FORMAT:
    -WBLOCK
    "path\block_name.dwg"
    =blockname
    -WBLOCK
    "path\block_name.dwg"
    =blockname

STEP 5: Run the Script
  â”œâ”€ In MacroManager dialog
  â”œâ”€ Click "RUN EXPORT SCRIPT"
  â””â”€ Expected: âœ“ AutoCAD creates DWG files WITHOUT crashing


ğŸ“‹ WHAT THIS FIX DOES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… FIXES:
  â€¢ "error: bad order function: COMMAND" error
  â€¢ Export process now completes successfully
  â€¢ Script file runs without crashing
  â€¢ All 369+ blocks can be exported

âœ… PRESERVES:
  â€¢ Block selection
  â€¢ CSV file generation
  â€¢ DWG file creation
  â€¢ Type/Category selection
  â€¢ All other export features


ğŸ¯ NEXT STEPS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. âœ… Fix Applied
   File: MacroManager_v5.13.lsp (lines 854-858)
   Status: READY TO TEST

2. ğŸ§ª Test the Export
   â€¢ Reload the file: (load "MacroManager_v5.13.lsp")
   â€¢ Try export with small batch (5-10 blocks)
   â€¢ Verify: No "bad order function" error
   â€¢ Check: DWG files created in Block Library folder

3. âœ… Then Test Import
   â€¢ Once export works, test import
   â€¢ Use the CSV file from export
   â€¢ Check checkpoint diagnostics [CP1-CP5]
   â€¢ Report results

4. ğŸ“Š Full Batch Testing
   â€¢ After small batch works, try all 369 blocks
   â€¢ Export all blocks successfully
   â€¢ Then proceed with import testing


âš ï¸ IF ERROR STILL OCCURS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

If you still get "error: bad order function: COMMAND" after this fix:

1. RELOAD THE FILE
   Make sure you have the LATEST version loaded
   (load "MacroManager_v5.13.lsp")

2. CHECK THE SCRIPT FILE
   Location: [Block Library]\export_blocks.scr
   Open in notepad and check:
   â€¢ No extra blank lines between commands
   â€¢ Format is: -WBLOCK\npath\n=blockname
   â€¢ Paths have quotes around them

3. TRY ALTERNATE EXPORT METHOD
   â€¢ In MACROMANAGER dialog
   â€¢ Select "VLA" method (more stable)
   â€¢ Click "EXPORT BLOCKS"
   â€¢ VLA method doesn't use script file, so avoids this issue

4. CHECK PERMISSIONS
   â€¢ Verify write access to Block Library folder
   â€¢ Verify disk space available
   â€¢ Try with simpler path (no special characters)


ğŸ“ DIAGNOSTIC INFORMATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

To check if the fix was applied correctly:

1. Open: MacroManager_v5.13.lsp in text editor
2. Go to: Line 857 (around export_blocks.scr generation)
3. Look for: "write-line (strcat "=" block_name) script_handle)"
4. Next line should be: ";; NO extra blank line here" or similar comment
5. If you see: "(write-line "" script_handle)" - the fix wasn't applied!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Fix Status: âœ… APPLIED - Ready to test!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
