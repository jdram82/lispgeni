â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MACRO MANAGER v5.14 - XREF IMPORT METHOD (CRASH-FREE!)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ MAJOR BREAKTHROUGH - NO MORE INSERT CRASHES!

This version completely eliminates the AutoCAD crash issue (Exception c0000027)
by using XREF attach method instead of INSERT command during import.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ WHAT'S NEW IN v5.14
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ NEW: XREF Import Method
  - Uses -XREF attach instead of INSERT command
  - No more AutoCAD crashes during import!
  - Based on proven XrefMacroManager v1.7 code

âœ“ NEW: Script-Based Import
  - Generates xref_import.scr file automatically
  - Script contains -XREF commands for each block
  - Safe execution - no direct command calls

âœ“ NEW: Auto-Execute Option
  - After script generation, dialog asks "Run now?"
  - Click YES to execute immediately
  - Click NO to run manually later

âœ“ NEW: Duplicate Handling
  - Detaches existing XREFs before re-attaching
  - No "block already exists" errors
  - Safe to re-import same blocks

âœ“ UNCHANGED: Export Function
  - Export works perfectly as-is
  - Script-based WBLOCK method
  - No changes needed

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‚ FILES REQUIRED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. MacroManager_v5.14.lsp  (Main program - 59KB)
2. MacroManager_v5.14.dcl  (Dialog interface - 10KB)

Both files must be in the same folder as your drawing!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ INSTALLATION & USAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: LOAD THE LISP FILE
---------------------------
1. Close all AutoCAD instances (clear cache)
2. Open your drawing in AutoCAD
3. Type: APPLOAD
4. Browse and select: MacroManager_v5.14.lsp
5. Click: Load
6. You should see: "âœ“ MacroManager v5.14 loaded!"

STEP 2: RUN THE DIALOG
-----------------------
1. Type command: MACROMANAGER
2. Dialog should open with title: "Professional Macro Manager v5.14 - XREF Import"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¤ EXPORT WORKFLOW (Unchanged - Working Perfectly)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. SELECT BLOCKS:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Choose mode: Single / Batch / All Blocks
   - Click: [1. SELECT BLOCKS...]
   - Select your blocks in the drawing
   - Dialog shows: "Selected: X blocks"

2. SET BLOCK TYPE:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Choose from dropdown: General / Power / Control / etc.
   - This type will be saved in CSV

3. SET EXPORT LIBRARY:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [Browse...] next to "Block Library Folder"
   - Select ANY file in your target folder
   - Path will be extracted automatically

4. SELECT CSV FILE:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [Browse...] next to "CSV File"
   - Enter filename: blocks.csv (or any name)
   - Click: Save

5. START EXPORT:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [â–º START EXPORT (CSV + DWG)]
   - Wait for completion message
   - CSV file created: blocks.csv
   - Script file created: export_blocks.scr

6. RUN EXPORT SCRIPT:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [â–¶ RUN EXPORT SCRIPT]
   - Script will execute automatically
   - DWG files will be created (one per block)
   - Wait for completion (5-10 minutes for 39 blocks)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¥ IMPORT WORKFLOW (NEW - XREF Method)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. OPEN TARGET DRAWING:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Open the drawing where you want to import blocks
   - OR create a new drawing

2. SET IMPORT LIBRARY:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [Browse...] next to "Block Library Folder" (Import section)
   - Select ANY file in the folder containing DWG files
   - Path will be extracted

3. SELECT CSV FILE:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [Browse...] next to "CSV File"
   - Select the CSV file from export step
   - Example: blocks.csv

4. PREVIEW (Optional):
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [â–º PREVIEW CSV]
   - Check list of blocks to be imported
   - Verify paths and coordinates

5. START IMPORT:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Click: [â–º START IMPORT]
   - Script file generated: xref_import.scr
   - Dialog asks: "Do you want to run the import script now?"

6. EXECUTE IMPORT:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Option A: Auto-Execute
   - Click: YES in the dialog
   - Script runs immediately
   - Watch command line for progress

   Option B: Manual Execution
   - Click: NO in the dialog
   - Later, type: SCRIPT
   - Select: xref_import.scr
   - Script will execute

7. VERIFY RESULTS:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   - Blocks appear as XREFs at correct coordinates
   - Type: XREF to see list of attached references
   - Each block is attached as separate XREF

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ UNDERSTANDING XREF IMPORT METHOD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

WHAT HAPPENS DURING IMPORT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

For each block in CSV:
1. Script tries to detach existing XREF (if any):
   -XREF â†’ D â†’ blockname

2. Script attaches block as XREF:
   -XREF â†’ A â†’ "path\blockname.dwg" â†’ blockname â†’ X,Y,Z â†’ 1 â†’ 0

WHY THIS METHOD WORKS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ“ XREF attach doesn't crash (unlike INSERT command)
âœ“ Each block is a separate external reference
âœ“ Blocks maintain connection to original DWG files
âœ“ Detach step prevents "already exists" errors
âœ“ Script execution is safe and predictable

DIFFERENCES FROM INSERT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

OLD METHOD (v5.13):    NEW METHOD (v5.14):
- Uses INSERT          - Uses XREF attach
- Crashes randomly     - Never crashes
- Direct command       - Script-based
- Embedded blocks      - External references

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š SCRIPT FILE STRUCTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

The generated xref_import.scr looks like this:

; XREF Import Script - Generated by MacroManager v5.14
; Safe alternative to INSERT command (no crashes!)
; Uses -XREF attach method instead of INSERT

; Block 1: WD511
-XREF
D
WD511

-XREF
A
"C:\Path\To\Library\WD511.dwg"
WD511
100.5,200.3,0.0
1
0

; Block 2: WD512
-XREF
D
WD512

-XREF
A
"C:\Path\To\Library\WD512.dwg"
WD512
150.2,250.8,0.0
1
0

; ... (continues for all blocks)

; Script generation complete
; Successfully processed: 39 blocks
; Failed/Skipped: 0 blocks

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ› ï¸ TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLEM: Dialog doesn't open
SOLUTION: 
- Ensure MacroManager_v5.14.dcl is in same folder as .lsp
- Check command line for DCL error messages
- Try: APPLOAD â†’ Load both files explicitly

PROBLEM: "No CSV file selected" during import
SOLUTION:
- Click [Browse...] and select CSV file
- Make sure file path is shown in dialog
- CSV file must exist in accessible location

PROBLEM: "No Block Library folder selected"
SOLUTION:
- Click [Browse...] in Block Library section
- Select ANY DWG file in the target folder
- Folder path will be extracted automatically

PROBLEM: Import script created but nothing happens
SOLUTION:
- Check command line for error messages
- Verify DWG files exist in Block Library folder
- Manually run: SCRIPT â†’ select xref_import.scr
- Watch for -XREF command execution

PROBLEM: "File not found" errors in script
SOLUTION:
- Verify Block Library path is correct
- Check that DWG files exist: blockname.dwg
- File names must match block names in CSV exactly
- Use RUN EXPORT SCRIPT before import to create DWGs

PROBLEM: Blocks appear but at wrong location
SOLUTION:
- Check CSV coordinates (columns 2, 3, 4)
- Verify CSV was exported from correct drawing
- Use PREVIEW CSV to verify coordinates before import

PROBLEM: "Block already exists" errors
SOLUTION:
- This shouldn't happen in v5.14!
- Script detaches existing XREFs first
- If error persists, manually detach: -XREF â†’ D â†’ blockname

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš™ï¸ ADVANCED OPTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BATCH IMPORT SETTINGS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Import Mode: "Import All Blocks" (default)
- Blocks per Batch: 20 (not used in v5.14 - all blocks imported)
- Start from block number: 2 (row 1 is header)

Note: v5.14 always imports all blocks via script method.
Batch settings are preserved for future versions.

XREF MANAGEMENT AFTER IMPORT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

To convert XREFs to permanent blocks:
1. Type: -XREF
2. Option: B (Bind)
3. Select XREF name
4. Type: 0 (Insert - makes it a regular block)

To detach specific XREF:
1. Type: -XREF
2. Option: D (Detach)
3. Enter XREF name

To reload XREF (update from source):
1. Type: -XREF
2. Option: R (Reload)
3. Enter XREF name

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ CSV FORMAT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CSV file contains 7 columns:

Block Name,X Coordinate,Y Coordinate,Z Coordinate,Type,Color,Linetype
WD511,100.5000,200.3000,0.0000,Power,256,ByLayer
WD512,150.2000,250.8000,0.0000,Control,7,Continuous

Column Details:
- Block Name: Name of block (must match DWG filename)
- X Coordinate: Insertion point X (decimal format)
- Y Coordinate: Insertion point Y (decimal format)
- Z Coordinate: Insertion point Z (usually 0.0000)
- Type: Block category (General/Power/Control/etc.)
- Color: AutoCAD color number (256 = ByLayer)
- Linetype: Linetype name (ByLayer/Continuous/etc.)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… SUCCESS CRITERIA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Export Success:
âœ“ CSV file created with all block coordinates
âœ“ export_blocks.scr created with WBLOCK commands
âœ“ After running script: DWG files created (one per block)
âœ“ All DWG files match block names exactly

Import Success:
âœ“ xref_import.scr generated with -XREF commands
âœ“ Script execution completes without crashes
âœ“ All blocks appear in drawing at correct coordinates
âœ“ XREF command shows list of attached references
âœ“ No "block already exists" errors

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ TESTED WORKFLOW (User's 39 Blocks)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

EXPORT: âœ… WORKING
- 39 blocks selected
- CSV generated: blocks.csv
- Script generated: export_blocks.scr
- Script executed: 39 DWG files created
- Time: ~5-10 minutes

IMPORT: ğŸ†• NEW IN v5.14 - NEEDS TESTING
- CSV selected: blocks.csv
- Library folder: [same as export]
- Script generated: xref_import.scr
- Expected result: 39 XREFs attached at correct positions
- Expected time: ~5 minutes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ SUPPORT & FEEDBACK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If you encounter any issues:
1. Check command line for error messages
2. Verify file paths are correct
3. Ensure DWG files exist before import
4. Try manual script execution: SCRIPT â†’ select .scr file
5. Report specific error messages for assistance

Version: 5.14
Date: November 12, 2025
Based on: XrefMacroManager v1.7 (working XREF import method)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
